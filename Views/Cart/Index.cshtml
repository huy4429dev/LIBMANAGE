@{
    Layout = "_Layout";
}

		<!-- Start Bradcaump area -->
		<div class="ht__bradcaump__area bg-image--3">
			<div class="container">
				<div class="row">
					<div class="col-lg-12">
						<div class="bradcaump__inner text-center">
							<h2 class="bradcaump-title">GIỎ HÀNG</h2>
							<nav class="bradcaump-content">
								<a class="breadcrumb_item" href="/">Trang chủ</a>
								<span class="brd-separetor">/</span>
								<span class="breadcrumb_item active">GIỞ HÀNG</span>
							</nav>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- End Bradcaump area -->
		<!-- cart-main-area start -->
		<div class="cart-main-area section-padding--lg bg--white">
			<div class="container">
				<div class="row">
					<div class="col-md-12 col-sm-12 ol-lg-12">
						<form action="#">
							<div class="table-content wnro__table table-responsive">
								<table>
									<thead>
										<tr class="title-top">
											<th class="product-thumbnail">Ảnh</th>
											<th class="product-name">Sách</th>
											@* <th class="product-price">Price</th> *@
											<th class="product-quantity">Số lượng</th>
											@* <th class="product-subtotal">Total</th> *@
											<th class="product-remove">Remove</th>
										</tr>
									</thead>
									<tbody>
										@if(ViewBag.dataCart.Count > 0){
											@foreach (var item in ViewBag.dataCart)
											{
												<tr>
													<td class="product-thumbnail"><a href="#"><img
																src="@item.Product.Image" alt="product img"></a></td>
													<td class="product-name"><a href="/product/@item.Product.Id">@item.Product.Title</a></td>
													@* <td class="product-price"><span class="amount">$165.00</span></td> *@
													<td class="product-quantity"><input type="number" value="1"></td>
													@* <td class="product-subtotal">$165.00</td> *@
													<td><button type="button" onclick="removeCartItem(@item.Product.Id)">X</button></td>
												</tr>
											}
										}
								</table>		
								@if(ViewBag.dataCart.Count == 0){
											<div class="alert alert-warning mt-2 text-center">Giở hàng của bạn chưa có sản phẩm nào</div>
								}
							</div>
						</form>
						<div class="cartbox__btn">
							<ul
								class="cart__btn__list d-flex flex-wrap flex-md-nowrap flex-lg-nowrap justify-content-end">
								<li class="mr-2"><a href="#">Cập nhật</a></li>
								<li><a href="#">Xác nhận</a></li>
							</ul>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-6 offset-lg-6">
						<div class="cartbox__total__area">
							<div class="cartbox-total d-flex justify-content-between">
								<ul class="cart__total__list">
									<li>Cart total</li>
									<li>Sub Total</li>
								</ul>
								<ul class="cart__total__tk">
									<li>$70</li>
									<li>$70</li>
								</ul>
							</div>
							<div class="cart__total__amount">
								<span>Grand Total</span>
								<span>$140</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
@section Script {
	<script>
		const eleCartListCart = document.querySelector('tbody');
		function product(id,title,image,quantity){

		 							return     `<tr>
													<td class="product-thumbnail"><a href="#"><img
																src="${image}" alt="product img"></a></td>
													<td class="product-name"><a href="/product/${id}">${title}</a></td>
													<td class="product-quantity"><input type="number" value="${quantity}"></td>
													<td><button type="button" onclick="removeCartItem(${id})">X</button></td>
												</tr>`
		 }

		function removeCartItem (id) {
			fetch(`${URL}/cart/remove/${id}`)
			.then(response => response.json())
			.then(data => {

				toastr.success('Cập nhật giỏ hàng thành công');
				data.dataCart.forEach(item => {
					itemsHTML += product(item.product.id, item.product.title, item.product.image,item.product.quantity);
				});
				eleCartListCart.innerHTML = itemsHTML;
				itemsHTML = '';
			})
			.catch(err => console.log("ERR: " + err.message));
		}

	</script>
}	